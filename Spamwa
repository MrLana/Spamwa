from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time
import random

def whatsapp_spammer_last_chat(message_count=10, delay_seconds=5):
    # Setup Chrome driver
    driver = webdriver.Chrome(executable_path='path_to_chromedriver')
    
    try:
        # Buka WhatsApp Web
        driver.get("https://web.whatsapp.com/")
        print("Silakan scan QR code WhatsApp Web...")
        
        # Tunggu sampai user sudah login
        wait = WebDriverWait(driver, 60)
        wait.until(EC.presence_of_element_located((By.XPATH, '//div[@contenteditable="true"][@data-tab="10"]')))
        
        # Pilih chat terakhir (tanpa perlu tahu nomor)
        last_chat = driver.find_element(By.XPATH, '(//div[@class="_2KKXC"]|//div[@class="_1RAKT"])[last()]')
        last_chat.click()
        time.sleep(2)
        
        # Temukan input box
        input_box = driver.find_element(By.XPATH, '//div[@contenteditable="true"][@data-tab="10"]')
        
        # Mulai mengirim pesan
        for i in range(message_count):
            # Generate random message or use fixed message
            message = f"Ini pesan spam ke-{i+1} - {random.randint(1000,9999)}"
            
            input_box.send_keys(message)
            input_box.send_keys(Keys.ENTER)
            print(f"Pesan {i+1}/{message_count} terkirim")
            
            time.sleep(delay_seconds)  # Delay untuk menghindari deteksi
            
    except Exception as e:
        print(f"Error: {str(e)}")
    finally:
        driver.quit()

# Penggunaan
whatsapp_spammer_last_chat(message_count=5, delay_seconds=10)
